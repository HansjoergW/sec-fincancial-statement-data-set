<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>secfsdstools.x_examples.automation.automation API documentation</title>
<meta name="description" content="This module shows the automation possibilities.
These are mainly providing a hook method, which can create additional steps that are executed
during â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>secfsdstools.x_examples.automation.automation</code></h1>
</header>
<section id="section-intro">
<p>This module shows the automation possibilities.
These are mainly providing a hook method, which can create additional steps that are executed
during the "check-for-update" (checking whether a new quarterly zip file is available), and
providing another hook-method, that is simply called at the end of the whole update process.</p>
<p>As a remainder, the framework executes all update steps (check and downloading new zip files,
transforming them to parquet, indexing the reports, and any additional steps that you define
as shown here.</p>
<p>Usually, you can configure these methods here in the secfsdstools configuration file, like</p>
<pre>
[DEFAULT]
downloaddirectory = ...
dbdirectory = ...
parquetdirectory = ...
useragentemail = ...
autoupdate = True
keepzipfiles = False
postppdatehook=secfsdstools.x_examples.automation.automation.after_update
postupdateprocesses=secfsdstools.x_examples.automation.automation.define_extra_processes
</pre>
<p>In this example, we have a config file "automation_config.cfg" which we are going to use in the
<strong>main</strong> section of this module.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
This module shows the automation possibilities.
These are mainly providing a hook method, which can create additional steps that are executed
during the &#34;check-for-update&#34; (checking whether a new quarterly zip file is available), and
providing another hook-method, that is simply called at the end of the whole update process.

As a remainder, the framework executes all update steps (check and downloading new zip files,
transforming them to parquet, indexing the reports, and any additional steps that you define
as shown here.

Usually, you can configure these methods here in the secfsdstools configuration file, like
&lt;pre&gt;
[DEFAULT]
downloaddirectory = ...
dbdirectory = ...
parquetdirectory = ...
useragentemail = ...
autoupdate = True
keepzipfiles = False
postppdatehook=secfsdstools.x_examples.automation.automation.after_update
postupdateprocesses=secfsdstools.x_examples.automation.automation.define_extra_processes
&lt;/pre&gt;

In this example, we have a config file &#34;automation_config.cfg&#34; which we are going to use in the
__main__ section of this module.
&#34;&#34;&#34;
import logging
import os
import shutil
from pathlib import Path
from typing import List

from secfsdstools.a_config.configmodel import Configuration
from secfsdstools.a_utils.fileutils import get_directories_in_directory
from secfsdstools.c_automation.task_framework import AbstractProcess, Task, delete_temp_folders
from secfsdstools.d_container.databagmodel import JoinedDataBag
from secfsdstools.f_standardize.bs_standardize import BalanceSheetStandardizer
from secfsdstools.f_standardize.cf_standardize import CashFlowStandardizer
from secfsdstools.f_standardize.is_standardize import IncomeStatementStandardizer

CURRENT_DIR, _ = os.path.split(__file__)


class StandardizerTask:

    def __init__(self,
                 root_path: Path,
                 target_path: Path):
        self.root_path = root_path

        self.target_path = target_path
        self.dir_name = target_path.name
        self.tmp_path = target_path.parent / f&#34;tmp_{self.dir_name}&#34;

    def prepare(self):
        (self.tmp_path / &#34;BS&#34;).mkdir(parents=True, exist_ok=False)
        (self.tmp_path / &#34;IS&#34;).mkdir(parents=True, exist_ok=False)
        (self.tmp_path / &#34;CF&#34;).mkdir(parents=True, exist_ok=False)

    def commit(self):
        &#34;&#34;&#34; we commit by renaming the tmp_path. &#34;&#34;&#34;
        self.tmp_path.rename(self.target_path)
        return &#34;success&#34;

    def exception(self, exception) -&gt; str:
        &#34;&#34;&#34; delete the temp folder. &#34;&#34;&#34;
        shutil.rmtree(self.tmp_path, ignore_errors=True)
        return f&#34;failed {exception}&#34;

    def __str__(self) -&gt; str:
        return (f&#34;StandardizerTask(root_path: {self.root_path}, &#34;
                f&#34;target_path: {self.target_path})&#34;)

    def execute(self):
        bs_standardizer = BalanceSheetStandardizer()
        is_standardizer = IncomeStatementStandardizer()
        cf_standardizer = CashFlowStandardizer()

        # load data
        joined_bag = JoinedDataBag.load(str(self.root_path))

        # standardize bs
        # bs_standardizer.process(joined_bag.pre_num_df.copy())
        # bs_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;BS&#34;))

        # standardize is
        is_standardizer.process(joined_bag.pre_num_df.copy())
        is_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;IS&#34;))

        # standardize cf
        cf_standardizer.process(joined_bag.pre_num_df.copy())
        cf_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;CF&#34;))


class StandardizeProcess(AbstractProcess):

    def __init__(self,
                 root_dir: str,
                 target_dir: str,
                 file_type: str = &#34;quarter&#34;,
                 execute_serial: bool = False
                 ):
        super().__init__(execute_serial=execute_serial,
                         chunksize=0)
        self.root_dir = root_dir
        self.target_dir = target_dir
        self.file_type = file_type

    def _get_available_filtered(self):
        return get_directories_in_directory(
            os.path.join(self.root_dir, self.file_type))

    def _get_standardized(self):
        return get_directories_in_directory(
            os.path.join(self.target_dir, self.file_type))

    def pre_process(self):
        delete_temp_folders(root_path=Path(self.target_dir) / self.file_type)

    def calculate_tasks(self) -&gt; List[Task]:
        filtered = self._get_available_filtered()
        standardized = self._get_standardized()

        missings = set(filtered) - set(standardized)

        return [StandardizerTask(
            root_path=Path(self.root_dir) / self.file_type / missing,
            target_path=Path(self.target_dir) / self.file_type / missing
        ) for missing in missings]


def define_extra_processes(config: Configuration) -&gt; List[AbstractProcess]:
    from secfsdstools.x_examples.automation.filter_process import FilterProcess
    from secfsdstools.x_examples.automation.combine_process import CombineProcess

    raw_dir = config.config_parser.get(section=&#34;Filter&#34;,
                                       option=&#34;filtered_dir_raw&#34;)
    joined_dir = config.config_parser.get(section=&#34;Filter&#34;,
                                          option=&#34;filtered_dir_joined&#34;)
    joined_by_stmt_dir = config.config_parser.get(section=&#34;Filter&#34;,
                                                  option=&#34;filtered_dir_by_stmt_joined&#34;)
    standardized_dir = config.config_parser.get(section=&#34;Standardizer&#34;,
                                                option=&#34;standardized_dir&#34;)

    return [
        # raw
        FilterProcess(parquet_dir=config.parquet_dir,
                      target_dir=raw_dir,
                      bag_type=&#34;raw&#34;,
                      save_by_stmt=False,
                      execute_serial=False  # switch to true in case of memory problems
                      ),
        CombineProcess(root_dir=f&#34;{raw_dir}/quarter&#34;,
                       target_dir=f&#34;{raw_dir}/all&#34;,
                       bag_type=&#34;raw&#34;
                       ),

        # joined
        FilterProcess(parquet_dir=config.parquet_dir,
                      target_dir=joined_dir,
                      bag_type=&#34;joined&#34;,
                      save_by_stmt=False,
                      execute_serial=False  # switch to true in case of memory problems
                      ),
        CombineProcess(root_dir=f&#34;{joined_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_dir}/all&#34;,
                       bag_type=&#34;joined&#34;
                       ),

        # joined by stmt
        FilterProcess(parquet_dir=config.parquet_dir,
                      target_dir=f&#34;{joined_by_stmt_dir}&#34;,
                      bag_type=&#34;joined&#34;,
                      save_by_stmt=True,
                      stmts=[&#34;BS&#34;, &#34;CF&#34;, &#34;CI&#34;, &#34;CP&#34;, &#34;EQ&#34;, &#34;IS&#34;],
                      execute_serial=False,  # switch to true in case of memory problems
                      ),

        # building datasets with all entries by stmt
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/BS&#34;,
                       filter=&#34;*/BS&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/CF&#34;,
                       filter=&#34;*/CF&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/CI&#34;,
                       filter=&#34;*/CI&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/CP&#34;,
                       filter=&#34;*/CP&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/EQ&#34;,
                       filter=&#34;*/EQ&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/IS&#34;,
                       filter=&#34;*/IS&#34;,
                       bag_type=&#34;joined&#34;
                       ),

        # building an all dataset based on the all-by-stmt datasets
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all&#34;,
                       bag_type=&#34;joined&#34;
                       ),

        StandardizeProcess(root_dir=joined_dir,
                           target_dir=standardized_dir,
                           execute_serial=False)

    ]


def after_update(config: Configuration):
    pass


if __name__ == &#39;__main__&#39;:
    from secfsdstools.a_config.configmgt import ConfigurationManager, SECFSDSTOOLS_ENV_VAR_NAME
    from secfsdstools.c_update.updateprocess import Updater

    logging.basicConfig(
        level=logging.INFO,
        format=&#34;%(asctime)s [%(levelname)s] %(module)s  %(message)s&#34;,
        handlers=[
            logging.StreamHandler()
        ]
    )

    # define which configuration file to use
    os.environ[SECFSDSTOOLS_ENV_VAR_NAME] = f&#34;{CURRENT_DIR}/automation_config.cfg&#34;

    config = ConfigurationManager.read_config_file()

    updater = Updater.get_instance(config)

    # We call this method mainly for demonstration purpose. Therefore, we also set
    # force_update=True, so that update process is being executed, regardless if the last
    # update process run less than 24 hours before.

    # You could also just start to use any feature of the framework. This would also trigger the
    # update process to run, but at most once every 24 hours.
    updater.update(force_update=True)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="secfsdstools.x_examples.automation.automation.after_update"><code class="name flex">
<span>def <span class="ident">after_update</span></span>(<span>config:Â <a title="secfsdstools.a_config.configmodel.Configuration" href="../../a_config/configmodel.html#secfsdstools.a_config.configmodel.Configuration">Configuration</a>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def after_update(config: Configuration):
    pass</code></pre>
</details>
</dd>
<dt id="secfsdstools.x_examples.automation.automation.define_extra_processes"><code class="name flex">
<span>def <span class="ident">define_extra_processes</span></span>(<span>config:Â <a title="secfsdstools.a_config.configmodel.Configuration" href="../../a_config/configmodel.html#secfsdstools.a_config.configmodel.Configuration">Configuration</a>) â€‘>Â List[<a title="secfsdstools.c_automation.task_framework.AbstractProcess" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess">AbstractProcess</a>]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def define_extra_processes(config: Configuration) -&gt; List[AbstractProcess]:
    from secfsdstools.x_examples.automation.filter_process import FilterProcess
    from secfsdstools.x_examples.automation.combine_process import CombineProcess

    raw_dir = config.config_parser.get(section=&#34;Filter&#34;,
                                       option=&#34;filtered_dir_raw&#34;)
    joined_dir = config.config_parser.get(section=&#34;Filter&#34;,
                                          option=&#34;filtered_dir_joined&#34;)
    joined_by_stmt_dir = config.config_parser.get(section=&#34;Filter&#34;,
                                                  option=&#34;filtered_dir_by_stmt_joined&#34;)
    standardized_dir = config.config_parser.get(section=&#34;Standardizer&#34;,
                                                option=&#34;standardized_dir&#34;)

    return [
        # raw
        FilterProcess(parquet_dir=config.parquet_dir,
                      target_dir=raw_dir,
                      bag_type=&#34;raw&#34;,
                      save_by_stmt=False,
                      execute_serial=False  # switch to true in case of memory problems
                      ),
        CombineProcess(root_dir=f&#34;{raw_dir}/quarter&#34;,
                       target_dir=f&#34;{raw_dir}/all&#34;,
                       bag_type=&#34;raw&#34;
                       ),

        # joined
        FilterProcess(parquet_dir=config.parquet_dir,
                      target_dir=joined_dir,
                      bag_type=&#34;joined&#34;,
                      save_by_stmt=False,
                      execute_serial=False  # switch to true in case of memory problems
                      ),
        CombineProcess(root_dir=f&#34;{joined_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_dir}/all&#34;,
                       bag_type=&#34;joined&#34;
                       ),

        # joined by stmt
        FilterProcess(parquet_dir=config.parquet_dir,
                      target_dir=f&#34;{joined_by_stmt_dir}&#34;,
                      bag_type=&#34;joined&#34;,
                      save_by_stmt=True,
                      stmts=[&#34;BS&#34;, &#34;CF&#34;, &#34;CI&#34;, &#34;CP&#34;, &#34;EQ&#34;, &#34;IS&#34;],
                      execute_serial=False,  # switch to true in case of memory problems
                      ),

        # building datasets with all entries by stmt
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/BS&#34;,
                       filter=&#34;*/BS&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/CF&#34;,
                       filter=&#34;*/CF&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/CI&#34;,
                       filter=&#34;*/CI&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/CP&#34;,
                       filter=&#34;*/CP&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/EQ&#34;,
                       filter=&#34;*/EQ&#34;,
                       bag_type=&#34;joined&#34;
                       ),
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/quarter&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt/IS&#34;,
                       filter=&#34;*/IS&#34;,
                       bag_type=&#34;joined&#34;
                       ),

        # building an all dataset based on the all-by-stmt datasets
        CombineProcess(root_dir=f&#34;{joined_by_stmt_dir}/all_by_stmt&#34;,
                       target_dir=f&#34;{joined_by_stmt_dir}/all&#34;,
                       bag_type=&#34;joined&#34;
                       ),

        StandardizeProcess(root_dir=joined_dir,
                           target_dir=standardized_dir,
                           execute_serial=False)

    ]</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="secfsdstools.x_examples.automation.automation.StandardizeProcess"><code class="flex name class">
<span>class <span class="ident">StandardizeProcess</span></span>
<span>(</span><span>root_dir:Â str, target_dir:Â str, file_type:Â strÂ =Â 'quarter', execute_serial:Â boolÂ =Â False)</span>
</code></dt>
<dd>
<div class="desc"><p>Defines the Abstract process of processing tasks for a certain process.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class StandardizeProcess(AbstractProcess):

    def __init__(self,
                 root_dir: str,
                 target_dir: str,
                 file_type: str = &#34;quarter&#34;,
                 execute_serial: bool = False
                 ):
        super().__init__(execute_serial=execute_serial,
                         chunksize=0)
        self.root_dir = root_dir
        self.target_dir = target_dir
        self.file_type = file_type

    def _get_available_filtered(self):
        return get_directories_in_directory(
            os.path.join(self.root_dir, self.file_type))

    def _get_standardized(self):
        return get_directories_in_directory(
            os.path.join(self.target_dir, self.file_type))

    def pre_process(self):
        delete_temp_folders(root_path=Path(self.target_dir) / self.file_type)

    def calculate_tasks(self) -&gt; List[Task]:
        filtered = self._get_available_filtered()
        standardized = self._get_standardized()

        missings = set(filtered) - set(standardized)

        return [StandardizerTask(
            root_path=Path(self.root_dir) / self.file_type / missing,
            target_path=Path(self.target_dir) / self.file_type / missing
        ) for missing in missings]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="secfsdstools.c_automation.task_framework.AbstractProcess" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess">AbstractProcess</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="secfsdstools.c_automation.task_framework.AbstractProcess" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess">AbstractProcess</a></b></code>:
<ul class="hlist">
<li><code><a title="secfsdstools.c_automation.task_framework.AbstractProcess.calculate_tasks" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess.calculate_tasks">calculate_tasks</a></code></li>
<li><code><a title="secfsdstools.c_automation.task_framework.AbstractProcess.post_process" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess.post_process">post_process</a></code></li>
<li><code><a title="secfsdstools.c_automation.task_framework.AbstractProcess.pre_process" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess.pre_process">pre_process</a></code></li>
<li><code><a title="secfsdstools.c_automation.task_framework.AbstractProcess.process" href="../../c_automation/task_framework.html#secfsdstools.c_automation.task_framework.AbstractProcess.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="secfsdstools.x_examples.automation.automation.StandardizerTask"><code class="flex name class">
<span>class <span class="ident">StandardizerTask</span></span>
<span>(</span><span>root_path:Â pathlib.Path, target_path:Â pathlib.Path)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class StandardizerTask:

    def __init__(self,
                 root_path: Path,
                 target_path: Path):
        self.root_path = root_path

        self.target_path = target_path
        self.dir_name = target_path.name
        self.tmp_path = target_path.parent / f&#34;tmp_{self.dir_name}&#34;

    def prepare(self):
        (self.tmp_path / &#34;BS&#34;).mkdir(parents=True, exist_ok=False)
        (self.tmp_path / &#34;IS&#34;).mkdir(parents=True, exist_ok=False)
        (self.tmp_path / &#34;CF&#34;).mkdir(parents=True, exist_ok=False)

    def commit(self):
        &#34;&#34;&#34; we commit by renaming the tmp_path. &#34;&#34;&#34;
        self.tmp_path.rename(self.target_path)
        return &#34;success&#34;

    def exception(self, exception) -&gt; str:
        &#34;&#34;&#34; delete the temp folder. &#34;&#34;&#34;
        shutil.rmtree(self.tmp_path, ignore_errors=True)
        return f&#34;failed {exception}&#34;

    def __str__(self) -&gt; str:
        return (f&#34;StandardizerTask(root_path: {self.root_path}, &#34;
                f&#34;target_path: {self.target_path})&#34;)

    def execute(self):
        bs_standardizer = BalanceSheetStandardizer()
        is_standardizer = IncomeStatementStandardizer()
        cf_standardizer = CashFlowStandardizer()

        # load data
        joined_bag = JoinedDataBag.load(str(self.root_path))

        # standardize bs
        # bs_standardizer.process(joined_bag.pre_num_df.copy())
        # bs_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;BS&#34;))

        # standardize is
        is_standardizer.process(joined_bag.pre_num_df.copy())
        is_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;IS&#34;))

        # standardize cf
        cf_standardizer.process(joined_bag.pre_num_df.copy())
        cf_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;CF&#34;))</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="secfsdstools.x_examples.automation.automation.StandardizerTask.commit"><code class="name flex">
<span>def <span class="ident">commit</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>we commit by renaming the tmp_path.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def commit(self):
    &#34;&#34;&#34; we commit by renaming the tmp_path. &#34;&#34;&#34;
    self.tmp_path.rename(self.target_path)
    return &#34;success&#34;</code></pre>
</details>
</dd>
<dt id="secfsdstools.x_examples.automation.automation.StandardizerTask.exception"><code class="name flex">
<span>def <span class="ident">exception</span></span>(<span>self, exception) â€‘>Â str</span>
</code></dt>
<dd>
<div class="desc"><p>delete the temp folder.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def exception(self, exception) -&gt; str:
    &#34;&#34;&#34; delete the temp folder. &#34;&#34;&#34;
    shutil.rmtree(self.tmp_path, ignore_errors=True)
    return f&#34;failed {exception}&#34;</code></pre>
</details>
</dd>
<dt id="secfsdstools.x_examples.automation.automation.StandardizerTask.execute"><code class="name flex">
<span>def <span class="ident">execute</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def execute(self):
    bs_standardizer = BalanceSheetStandardizer()
    is_standardizer = IncomeStatementStandardizer()
    cf_standardizer = CashFlowStandardizer()

    # load data
    joined_bag = JoinedDataBag.load(str(self.root_path))

    # standardize bs
    # bs_standardizer.process(joined_bag.pre_num_df.copy())
    # bs_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;BS&#34;))

    # standardize is
    is_standardizer.process(joined_bag.pre_num_df.copy())
    is_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;IS&#34;))

    # standardize cf
    cf_standardizer.process(joined_bag.pre_num_df.copy())
    cf_standardizer.get_standardize_bag().save(str(self.tmp_path / &#34;CF&#34;))</code></pre>
</details>
</dd>
<dt id="secfsdstools.x_examples.automation.automation.StandardizerTask.prepare"><code class="name flex">
<span>def <span class="ident">prepare</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def prepare(self):
    (self.tmp_path / &#34;BS&#34;).mkdir(parents=True, exist_ok=False)
    (self.tmp_path / &#34;IS&#34;).mkdir(parents=True, exist_ok=False)
    (self.tmp_path / &#34;CF&#34;).mkdir(parents=True, exist_ok=False)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="secfsdstools.x_examples.automation" href="index.html">secfsdstools.x_examples.automation</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="secfsdstools.x_examples.automation.automation.after_update" href="#secfsdstools.x_examples.automation.automation.after_update">after_update</a></code></li>
<li><code><a title="secfsdstools.x_examples.automation.automation.define_extra_processes" href="#secfsdstools.x_examples.automation.automation.define_extra_processes">define_extra_processes</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="secfsdstools.x_examples.automation.automation.StandardizeProcess" href="#secfsdstools.x_examples.automation.automation.StandardizeProcess">StandardizeProcess</a></code></h4>
</li>
<li>
<h4><code><a title="secfsdstools.x_examples.automation.automation.StandardizerTask" href="#secfsdstools.x_examples.automation.automation.StandardizerTask">StandardizerTask</a></code></h4>
<ul class="">
<li><code><a title="secfsdstools.x_examples.automation.automation.StandardizerTask.commit" href="#secfsdstools.x_examples.automation.automation.StandardizerTask.commit">commit</a></code></li>
<li><code><a title="secfsdstools.x_examples.automation.automation.StandardizerTask.exception" href="#secfsdstools.x_examples.automation.automation.StandardizerTask.exception">exception</a></code></li>
<li><code><a title="secfsdstools.x_examples.automation.automation.StandardizerTask.execute" href="#secfsdstools.x_examples.automation.automation.StandardizerTask.execute">execute</a></code></li>
<li><code><a title="secfsdstools.x_examples.automation.automation.StandardizerTask.prepare" href="#secfsdstools.x_examples.automation.automation.StandardizerTask.prepare">prepare</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>